<div class="game-level-container">
    <div class="sr-only" id="announcer-region" role="alert" aria-live="assertive"></div>
    
    <!-- State 1: Loading (Skeleton) -->
    <div id="level-loading-state" class="game-level-state active">
        <div class="state-content card hud-corners">
             <div class="skeleton-header">
                <div class="skeleton" style="width: 60%; height: 32px; margin-bottom: 20px;"></div>
             </div>
             <div id="loading-text-container" style="margin-top: 40px; display: flex; flex-direction: column; align-items: center;">
                 <svg class="mini-logo-pulse" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M96 416 L232 136 L256 180 L170 416 H96Z" fill="var(--color-primary)" />
                    <path d="M416 416 L280 136 L256 180 L342 416 H416Z" fill="var(--color-secondary)" />
                    <circle cx="256" cy="100" r="32" fill="#0033A0" stroke="white" stroke-width="4" />
                 </svg>
                 <p id="loading-status-text" style="text-align: center; margin-top: 20px; font-weight: 600;">Constructing neural pathway...</p>
                 <button id="cancel-generation-btn" class="btn" style="margin-top: 10px;">Cancel</button>
             </div>
        </div>
    </div>

    <!-- State 2: Lesson -->
    <div id="level-lesson-state" class="game-level-state">
        <div class="state-content card hud-corners">
            <header class="lesson-header"><h1 id="lesson-title"></h1></header>
            <main id="lesson-body" class="lesson-body"></main>
            <footer class="lesson-footer">
                <button id="ask-ai-btn" class="btn"><svg class="icon"><use href="#search"/></svg><span>Deep Dive</span></button>
                <button id="read-aloud-btn" class="btn"><svg class="icon"><use href="#volume-2"/></svg><span>Read Aloud</span></button>
                <button id="start-quiz-btn" class="btn btn-primary"><span>Let's Go!</span><svg class="icon"><use href="#arrow-right"/></svg></button>
            </footer>
        </div>
    </div>

    <!-- State 3: Quiz -->
    <div id="level-quiz-state" class="game-level-state">
        <header class="new-quiz-header">
            <div class="quiz-header-brand">
                <a href="#/" class="logo-link-header">
                    <div class="logo-container-header">
                        <svg class="logo-svg" viewBox="0 0 100 100" fill="none"><path d="M50 5 L95 27.5 V72.5 L50 95 L5 72.5 V27.5 Z" stroke="var(--color-primary)" stroke-width="4" fill="none" /><circle cx="50" cy="55" r="4" fill="var(--color-primary)"/></svg>
                    </div>
                    <span class="brand-text-header">Skill Apex</span>
                </a>
            </div>
            <div class="quiz-header-actions">
                <div id="combo-display" class="combo-display hidden"><span id="combo-count">0</span><span class="combo-label">COMBO</span></div>
                <button id="quit-btn" class="btn btn-danger"><svg class="icon"><use href="#x-circle"/></svg></button>
            </div>
        </header>

        <div class="new-quiz-content">
            <div class="quiz-status-card">
                <div class="timer-section"><p>Time</p><span id="timer-text">01:00</span></div>
                <div class="question-progress-section">
                    <p id="quiz-progress-text">Question 1</p>
                    <div class="progress-bar"><div id="quiz-progress-bar-fill" class="progress-bar-fill"></div></div>
                </div>
            </div>
            <div id="question-container" class="card main-question-card hud-corners">
                <h2 id="quiz-question-text">Loading...</h2>
                <div id="quiz-options-container" class="options-grid"></div>
            </div>
        </div>
        <footer class="new-quiz-footer">
             <button id="home-btn" class="btn"><svg class="icon"><use href="#home"/></svg></button>
             <button id="hint-btn" class="btn"><svg class="icon"><use href="#lightbulb"/></svg></button>
            <div class="footer-spacer"></div>
            <button id="submit-answer-btn" class="btn btn-primary" disabled>Submit Answer</button>
        </footer>
    </div>
    
    <!-- State 4: Results -->
    <div id="level-results-state" class="game-level-state">
        <div class="state-content card results-content hud-corners">
            <h1 id="results-title"></h1>
            <p id="xp-gain-text" class="xp-gain"></p>
            <p id="results-details"></p>
            <div id="results-actions" class="results-actions"></div>
        </div>
    </div>
</div>
